<%#
# Collection

This partial is used on the `index` and `show` pages
to display a collection of resources in an HTML table.

## Local variables:

- `collection_presenter`:
  An instance of [Administrate::Page::Collection][1].
  The table presenter uses `ResourceDashboard::COLLECTION_ATTRIBUTES` to determine
  the columns and orde of the table's headings.

[1]: http://www.rubydoc.info/gems/administrate/Administrate/Page/Collection
%>

<table aria-labelledby="<%= collection_presenter.resource_name %>">
  <thead>
    <tr>
      <% collection_presenter.attribute_names.each do |attr_name| %>
        <th class="cell-label cell-label--<%= collection_presenter.attribute_types[attr_name] %>" scope="col">
          <%= t(
            "helpers.label.#{collection_presenter.resource_name}.#{attr_name}",
            default: attr_name.to_s.titleize,
          ) %>
        </th>
      <% end %>
      <th scope="col">操作</th>
    </tr>
  </thead>

  <tbody>
    <% resources.each do |resource| %>
      <tr class="js-table-row"
          tabindex="0"
          >
        <% collection_presenter.attribute_names.each do |attr_name| %>
          <% field = collection_presenter.attribute_types[attr_name].new(attr_name, resource.send(attr_name), collection_presenter) %>
          <td class="cell-data cell-data--<%= field.html_class %>">
            <%= render_field field %>
          </td>
        <% end %>

        <td>
          <%= link_to(
            'PDF',
            admin_invoice_pdf_path(resource),
            class: 'action-show',
            target: '_blank'
          ) %>
          <%= link_to(
            t("administrate.actions.show"),
            [namespace, resource],
            class: "action-show",
          ) %>
          <%= link_to(
            t("administrate.actions.edit"),
            [:edit, namespace, resource],
            class: "action-edit",
          ) %>
          <%= link_to(
            t("administrate.actions.destroy"),
            [namespace, resource],
            class: "action-destroy",
            method: :delete,
            data: { confirm: t("administrate.actions.confirm") }
          ) %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
